{"ast":null,"code":"import React,{useContext,useState,useEffect}from'react';import{AccountContext}from'./context';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Deposit=()=>{const{giveth,currentUser,setCurrentUser,setProfileData,profileData}=useContext(AccountContext);const[depositAmount,setDepositAmount]=useState('');const[depositError,setDepositError]=useState(null);const[usingTotal,setUsingTotal]=useState(true);const[total,setTotal]=useState([]);const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem('token');if(!token){navigate('/');}});useEffect(()=>{if(!currentUser){setCurrentUser(JSON.parse(localStorage.getItem('currentUser')));}},[currentUser,setCurrentUser]);useEffect(()=>{console.log(currentUser);});useEffect(()=>{if(currentUser){const fetchProfileTotal=async()=>{try{const token=localStorage.getItem('token');const response=await axios.get(\"http://localhost:5000/api/auth/profile/\".concat(currentUser,\"/total\"),{headers:{Authorization:\"Bearer \".concat(token)}});// setProfileData(response.data)\nsetTotal(response.data.user.balance);// Set profile data to the response data object\nconsole.log(\"total:  \"+total);}catch(error){console.error('Error fetching profile data:',error);console.error('An error occurred while fetching profile data. Please try again later.');}};fetchProfileTotal();}},[currentUser,setProfileData,total]);const yup=()=>toast.success(\"deposit successful! :)\",{position:'top-center',closeOnClick:true,theme:'colored',hideProgressBar:true,autoClose:3000});const nope=()=>toast.error(\"deposit unsuccessful. :(\",{position:'top-center',closeOnClick:true,theme:'colored',hideProgressBar:true,autoClose:3000});const handleSubmit=e=>{e.preventDefault();if(depositAmount<=0){nope();return null;}yup();giveth(depositAmount);const depositCall=async()=>{try{const token=localStorage.getItem('token');const response=await axios.post(\"http://localhost:5000/api/auth/profile/\".concat(currentUser,\"/deposit\"),{currentUser,depositAmount},{headers:{Authorization:\"Bearer \".concat(token)}});setProfileData(response.data);setUsingTotal(false);// setTotal(response.data.user.balance)\n}catch(error){console.log(\"depositAmount in depositcall error: \"+depositAmount);console.error('Error making deposit (deposit.js - axios call): ',error);setDepositError('An error occurred while making deposit. get rekt lmao.');}};depositCall();};const handleInputChange=e=>{setDepositAmount(e.target.value);};if(depositError){return/*#__PURE__*/_jsx(\"div\",{children:depositError});}return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-center mt-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card col-lg-6 col-md-8 col-sm-6 shadow-lg border border-3 border-dark bg-light \",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container  d-flex justify-content-center\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>handleSubmit(e),children:[/*#__PURE__*/_jsx(\"h1\",{className:\"card-title d-flex justify-content-center mb-3\",children:\"Deposit\"}),usingTotal&&/*#__PURE__*/_jsxs(\"h4\",{className:\"ms-3\",children:[\"User Balance: $\",total,\".00\"]}),usingTotal===false&&/*#__PURE__*/_jsxs(\"h4\",{className:\"ms-3\",children:[\"User Balance: $\",profileData.balance,\".00\"]}),/*#__PURE__*/_jsx(\"label\",{className:\"m-2\",children:\"enter deposit amount below:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:depositAmount,onChange:e=>handleInputChange(e),placeholder:\"$0.00...\",className:\"form-control shadow-lg border border-2 border-secondary\",autoFocus:true}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center mt-3\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark shadow-lg\",type:\"submit\",children:/*#__PURE__*/_jsx(\"b\",{children:\"submit\"})})})]})})})}),/*#__PURE__*/_jsx(ToastContainer,{toastStyle:{border:'4px solid peachpuff'}})]});};export default Deposit;","map":{"version":3,"names":["React","useContext","useState","useEffect","AccountContext","ToastContainer","toast","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Deposit","giveth","currentUser","setCurrentUser","setProfileData","profileData","depositAmount","setDepositAmount","depositError","setDepositError","usingTotal","setUsingTotal","total","setTotal","navigate","token","localStorage","getItem","JSON","parse","console","log","fetchProfileTotal","response","get","concat","headers","Authorization","data","user","balance","error","yup","success","position","closeOnClick","theme","hideProgressBar","autoClose","nope","handleSubmit","e","preventDefault","depositCall","post","handleInputChange","target","value","children","className","onSubmit","type","onChange","placeholder","autoFocus","toastStyle","border"],"sources":["/Users/mrc/bb/client/src/visitable/deposit.js"],"sourcesContent":["\nimport React, { useContext, useState, useEffect } from 'react'\nimport { AccountContext } from './context'\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom'\n\nconst Deposit = () => {\n\n    const { giveth, currentUser, setCurrentUser, setProfileData, profileData } = useContext(AccountContext)\n    const [depositAmount, setDepositAmount] = useState('')\n    const [depositError, setDepositError] = useState(null)\n    const [usingTotal, setUsingTotal] = useState(true)\n    const [total, setTotal] = useState([])\n    const navigate = useNavigate();\n    useEffect(() => {\n        const token = localStorage.getItem('token')\n        if (!token) {\n            navigate('/')\n        }\n    })\n    useEffect(() => {\n        if (!currentUser) {\n\n            setCurrentUser(JSON.parse(localStorage.getItem('currentUser')))\n        }\n    }, [currentUser, setCurrentUser]);\n\n    useEffect(() => {\n        console.log(currentUser)\n    })\n\n    useEffect(() => {\n        if (currentUser) {\n            const fetchProfileTotal = async () => {\n                try {\n                    const token = localStorage.getItem('token');\n                    const response = await axios.get(`http://localhost:5000/api/auth/profile/${currentUser}/total`, {\n                        headers: { Authorization: `Bearer ${token}` }\n                    });\n                    // setProfileData(response.data)\n                    setTotal(response.data.user.balance); // Set profile data to the response data object\n                    console.log(\"total:  \" + total)\n                } catch (error) {\n                    console.error('Error fetching profile data:', error);\n                    console.error('An error occurred while fetching profile data. Please try again later.');\n                }\n            };\n            fetchProfileTotal();\n        }\n    }, [currentUser, setProfileData, total]);\n\n    const yup = () => toast.success(\"deposit successful! :)\", {\n        position: 'top-center',\n        closeOnClick: true,\n        theme: 'colored',\n        hideProgressBar: true,\n        autoClose: 3000,\n    })\n\n    const nope = () => toast.error(\"deposit unsuccessful. :(\", {\n        position: 'top-center',\n        closeOnClick: true,\n        theme: 'colored',\n        hideProgressBar: true,\n        autoClose: 3000,\n\n    })\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        if (depositAmount <= 0) {\n            nope()\n            return null\n        }\n        yup()\n        giveth(depositAmount)\n\n        const depositCall = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                const response = await axios.post(`http://localhost:5000/api/auth/profile/${currentUser}/deposit`,\n                    { currentUser, depositAmount }, {\n                    headers: { Authorization: `Bearer ${token}` }\n                });\n                setProfileData(response.data)\n                setUsingTotal(false)\n                // setTotal(response.data.user.balance)\n            } catch (error) {\n                console.log(\"depositAmount in depositcall error: \" + depositAmount)\n                console.error('Error making deposit (deposit.js - axios call): ', error);\n                setDepositError('An error occurred while making deposit. get rekt lmao.');\n            }\n        };\n        depositCall();\n    }\n\n    const handleInputChange = (e) => {\n        setDepositAmount(e.target.value)\n    }\n    if (depositError) {\n        return <div>{depositError}</div>;\n    }\n\n    return (\n        <div className='d-flex justify-content-center mt-4'>\n\n            <div className='card col-lg-6 col-md-8 col-sm-6 shadow-lg border border-3 border-dark bg-light '>\n                <div className='card-body'>\n                    <div className='container  d-flex justify-content-center'>\n                        <form onSubmit={(e) => handleSubmit(e)}>\n                            <h1 className='card-title d-flex justify-content-center mb-3'>Deposit</h1>\n                            {usingTotal &&\n                                <h4 className='ms-3'>User Balance: ${total}.00</h4>\n                            }\n                            {usingTotal === false &&\n                                <h4 className='ms-3'>User Balance: ${profileData.balance}.00</h4>\n                            }\n\n                            <label className='m-2'>enter deposit amount below:</label>\n                            <input type='number' value={depositAmount} onChange={(e) => handleInputChange(e)} placeholder='$0.00...' className='form-control shadow-lg border border-2 border-secondary' autoFocus />\n\n                            <div className='d-flex justify-content-center mt-3'>\n                                <button className='btn btn-dark shadow-lg' type='submit'><b>submit</b></button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n            <ToastContainer toastStyle={{ border: '4px solid peachpuff' }} />\n        </div>\n    )\n}\n\nexport default Deposit\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}