{"ast":null,"code":"import React,{useContext,useState,useEffect}from\"react\";import{AccountContext}from\"./context\";import{ToastContainer,toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import axios from\"axios\";import{Link}from\"react-router-dom\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Login=_ref=>{let{loginOrRegister,setLoginOrRegister}=_ref;const[tf,setTf]=useState(false);const{login,setAllUsers,setCurrentUser,currentUser}=useContext(AccountContext);const navigate=useNavigate();const[userData,setUserData]=useState({username:\"\",password:\"\"});useEffect(()=>{const token=localStorage.getItem(\"token\");if(token){console.log(\"already logged in\");console.log(token);}if(currentUser){navigate(\"/visitable/profile/\".concat(currentUser));}},[currentUser,navigate]);const arrayOfLoginWrongs=[\"username field empty or not in database or some other reason i can't remember.\",\"password must be at least eight characters\"];const woops=arrayOfLoginWrongs=>toast.error(arrayOfLoginWrongs,{position:\"top-center\",closeOnClick:true,theme:\"colored\",hideProgressBar:true,autoClose:3000});const hooray=()=>toast.success(\"Log in successful!!\",{position:\"top-center\",closeOnClick:true,theme:\"colored\",hideProgressBar:true,autoClose:3000});const handleFormChange=e=>{const{name,value}=e.target;setUserData(prevData=>({...prevData,[name]:value}));};const handleClearForm=e=>{e.preventDefault();setUserData({username:userData.username,email:userData.email,password:''});};const handleLoginSubmit=async e=>{e.preventDefault();if(userData.username.length===0){setTf(false);woops(arrayOfLoginWrongs[0]);}if(userData.password.length<=8){setTf(false);woops(arrayOfLoginWrongs[1]);handleClearForm(e);}if(userData.username.length>=1&&userData.password.length>8){setTf(true);login(userData);setAllUsers(prevAllUsers=>{return[...prevAllUsers,userData];});try{const response=await axios.post(\"http://localhost:5000/api/auth/login\",userData,{headers:{\"Content-Type\":\"application/json\"}});if(response.data&&response.data.token){const token=response.data.token;localStorage.setItem(\"token\",token);localStorage.setItem('userData',JSON.stringify(userData));setCurrentUser(response.data.user.username);localStorage.setItem('currentUser',JSON.stringify(response.data.user.username));hooray();navigate(\"/visitable/profile/\".concat(response.data.user.username));}}catch(error){woops(arrayOfLoginWrongs[0]);console.error(\"Error during Login:\",error);}}};const handleChangeToSignup=e=>{e.preventDefault();setLoginOrRegister(true);};return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-center \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card mx-auto my-auto col-md-12 col-lg-12 col-sm-12\",style:{border:\"none\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"row d-flex my-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body d-flex my-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container \",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"card-title d-flex justify-content-center \",children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>handleLoginSubmit(e),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group ms-5 me-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"m-3\",children:/*#__PURE__*/_jsx(\"input\",{className:\"form-control border border-2 border-secondary shadow-lg\",type:\"text\",name:\"username\",value:userData.username,onChange:e=>handleFormChange(e),placeholder:\"username\",autoFocus:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"m-3\",children:/*#__PURE__*/_jsx(\"input\",{className:\"form-control border border-2 border-secondary shadow-lg\",type:\"password\",name:\"password\",value:userData.password,onChange:e=>handleFormChange(e),placeholder:\"password\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"first time here?\",\" \",/*#__PURE__*/_jsx(Link,{onClick:e=>handleChangeToSignup(e),children:\"Sign Up\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark m-1 shadow-lg\",type:\"submit\",children:/*#__PURE__*/_jsx(\"b\",{children:\"Log In\"})})}),tf&&/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\"})]})]})})})}),/*#__PURE__*/_jsx(ToastContainer,{toastStyle:{border:\"4px solid peachpuff\"}})]});};export default Login;","map":{"version":3,"names":["React","useContext","useState","useEffect","AccountContext","ToastContainer","toast","axios","Link","useNavigate","jsx","_jsx","jsxs","_jsxs","Login","_ref","loginOrRegister","setLoginOrRegister","tf","setTf","login","setAllUsers","setCurrentUser","currentUser","navigate","userData","setUserData","username","password","token","localStorage","getItem","console","log","concat","arrayOfLoginWrongs","woops","error","position","closeOnClick","theme","hideProgressBar","autoClose","hooray","success","handleFormChange","e","name","value","target","prevData","handleClearForm","preventDefault","email","handleLoginSubmit","length","prevAllUsers","response","post","headers","data","setItem","JSON","stringify","user","handleChangeToSignup","className","children","style","border","onSubmit","type","onChange","placeholder","autoFocus","onClick","toastStyle"],"sources":["/Users/mrc/bb/client/src/visitable/login.js"],"sourcesContent":["import React, { useContext, useState, useEffect } from \"react\";\nimport { AccountContext } from \"./context\";\nimport { ToastContainer, toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst Login = ({ loginOrRegister, setLoginOrRegister }) => {\n  const [tf, setTf] = useState(false);\n  const { login, setAllUsers, setCurrentUser, currentUser } = useContext(AccountContext);\n  const navigate = useNavigate();\n\n  const [userData, setUserData] = useState({\n    username: \"\",\n    password: \"\",\n  });\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      console.log(\"already logged in\");\n      console.log(token)\n    }\n\n    if (currentUser) {\n      navigate(`/visitable/profile/${currentUser}`);\n    }\n  }, [currentUser, navigate]);\n\n  const arrayOfLoginWrongs = [\n    \"username field empty or not in database or some other reason i can't remember.\",\n    \"password must be at least eight characters\",\n  ];\n\n  const woops = (arrayOfLoginWrongs) =>\n    toast.error(arrayOfLoginWrongs, {\n      position: \"top-center\",\n      closeOnClick: true,\n      theme: \"colored\",\n      hideProgressBar: true,\n      autoClose: 3000,\n    });\n\n  const hooray = () =>\n    toast.success(\"Log in successful!!\", {\n      position: \"top-center\",\n      closeOnClick: true,\n      theme: \"colored\",\n      hideProgressBar: true,\n      autoClose: 3000,\n    });\n\n  const handleFormChange = (e) => {\n    const { name, value } = e.target;\n    setUserData((prevData) => ({\n      ...prevData,\n      [name]: value,\n    }));\n  };\n\n  const handleClearForm = (e) => {\n    e.preventDefault();\n    setUserData({\n      username: userData.username,\n      email: userData.email,\n      password: '',\n    })\n  }\n\n  const handleLoginSubmit = async (e) => {\n    e.preventDefault();\n    if (userData.username.length === 0) {\n      setTf(false);\n      woops(arrayOfLoginWrongs[0]);\n    }\n\n    if (userData.password.length <= 8) {\n      setTf(false);\n      woops(arrayOfLoginWrongs[1]);\n      handleClearForm(e)\n    }\n\n    if (userData.username.length >= 1 && userData.password.length > 8) {\n      setTf(true);\n      login(userData);\n      setAllUsers((prevAllUsers) => {\n        return [...prevAllUsers, userData];\n      });\n\n      try {\n        const response = await axios.post(\n          \"http://localhost:5000/api/auth/login\",\n          userData,\n          {\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n          }\n        );\n        if (response.data && response.data.token) {\n          const token = response.data.token;\n          localStorage.setItem(\"token\", token);\n          localStorage.setItem('userData', JSON.stringify(userData));\n\n          setCurrentUser(response.data.user.username);\n          localStorage.setItem('currentUser', JSON.stringify(response.data.user.username));\n\n          hooray();\n          navigate(`/visitable/profile/${response.data.user.username}`);\n        }\n      } catch (error) {\n        woops(arrayOfLoginWrongs[0]);\n        console.error(\"Error during Login:\", error);\n      }\n    }\n  };\n\n  const handleChangeToSignup = (e) => {\n    e.preventDefault();\n    setLoginOrRegister(true);\n  };\n\n  return (\n    <div className=\"d-flex justify-content-center \">\n      <div\n        className=\"card mx-auto my-auto col-md-12 col-lg-12 col-sm-12\"\n        style={{ border: \"none\" }}\n      >\n        <div className=\"row d-flex my-auto\">\n          <div className=\"card-body d-flex my-auto\">\n            <div className=\"container \">\n              <h1 className=\"card-title d-flex justify-content-center \">\n                Login\n              </h1>\n              <form onSubmit={(e) => handleLoginSubmit(e)}>\n                <div className=\"form-group ms-5 me-5\">\n                  <div className=\"m-3\">\n                    <input\n                      className=\"form-control border border-2 border-secondary shadow-lg\"\n                      type=\"text\"\n                      name=\"username\"\n                      value={userData.username}\n                      onChange={(e) => handleFormChange(e)}\n                      placeholder=\"username\"\n                      autoFocus\n                    />\n                  </div>\n                  <div className=\"m-3\">\n                    <input\n                      className=\"form-control border border-2 border-secondary shadow-lg\"\n                      type=\"password\"\n                      name=\"password\"\n                      value={userData.password}\n                      onChange={(e) => handleFormChange(e)}\n                      placeholder=\"password\"\n                    />\n                  </div>\n                  <div className=\"d-flex justify-content-center\">\n                    <p>\n                      first time here?{\" \"}\n                      <Link onClick={(e) => handleChangeToSignup(e)}>\n                        Sign Up\n                      </Link>\n                    </p>\n                  </div>\n                </div>\n                <div className=\"d-flex justify-content-center\">\n                  <button className=\"btn btn-dark m-1 shadow-lg\" type=\"submit\">\n                    <b>Log In</b>\n                  </button>\n                </div>\n                {tf && <div className=\"d-flex justify-content-center\"></div>}\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n      <ToastContainer toastStyle={{ border: \"4px solid peachpuff\" }} />\n    </div>\n  );\n};\n\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}