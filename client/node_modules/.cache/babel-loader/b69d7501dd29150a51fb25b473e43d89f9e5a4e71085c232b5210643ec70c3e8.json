{"ast":null,"code":"import React,{useEffect,useState,useContext}from\"react\";import{AccountContext}from\"./context\";import axios from\"axios\";import{useParams}from\"react-router-dom\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Profile=()=>{const{setCurrentUser,currentUser,profileData,setProfileData}=useContext(AccountContext);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const params=useParams();const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem('token');if(!token){navigate('/');}});useEffect(()=>{if(currentUser){console.log(\"profilejs useEffect currentUser: \"+currentUser);}if(!currentUser){setCurrentUser(JSON.parse(localStorage.getItem('currentUser')));}},[params.username,currentUser,setCurrentUser]);useEffect(()=>{if(currentUser){const fetchProfile=async()=>{try{const token=localStorage.getItem('token');const response=await axios.get(\"http://localhost:5000/api/auth/profile/\".concat(currentUser),{headers:{Authorization:\"Bearer \".concat(token)}});setLoading(false);// Set loading to false after data is fetched\nsetProfileData(response.data);// Set profile data to the response data object\nconsole.log(localStorage.getItem('token'));}catch(error){console.error('Error fetching profile data:',error);setError('An error occurred while fetching profile data. Please try again later.');setLoading(false);// Set loading to false in case of error\n}};fetchProfile();}},[currentUser,setProfileData]);if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});// Render loading state\n}if(error){return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error]});// Render error state\n}return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center mt-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card mx-auto my-auto col-md-8 col-lg-6 col-sm-10 border border-3 border-dark shadow-lg\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row d-flex my-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body d-flex my-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"card-title d-flex justify-content-center m-4\",children:[\"welcome, \",profileData.user.username,\"!\"]}),profileData&&/*#__PURE__*/_jsxs(\"div\",{className:\"fs-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"profile balance: $\",profileData.user.balance,\".00\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"email: \",profileData.user.email]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"account id: \",JSON.stringify(profileData.user._id).slice(15).replace('\"','')]})]})]})})})})});};export default Profile;","map":{"version":3,"names":["React","useEffect","useState","useContext","AccountContext","axios","useParams","useNavigate","jsx","_jsx","jsxs","_jsxs","Profile","setCurrentUser","currentUser","profileData","setProfileData","loading","setLoading","error","setError","params","navigate","token","localStorage","getItem","console","log","JSON","parse","username","fetchProfile","response","get","concat","headers","Authorization","data","children","className","user","balance","email","stringify","_id","slice","replace"],"sources":["/Users/mrc/bb/client/src/visitable/profile.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\nimport { AccountContext } from \"./context\";\nimport axios from \"axios\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst Profile = () => {\n  const { setCurrentUser, currentUser, profileData, setProfileData } = useContext(AccountContext);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const params = useParams();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const token = localStorage.getItem('token')\n    if (!token) {\n      navigate('/')\n    }\n  })\n\n  useEffect(() => {\n    if (currentUser) {\n      console.log(\"profilejs useEffect currentUser: \" + currentUser)\n    }\n    if (!currentUser) {\n      setCurrentUser(JSON.parse(localStorage.getItem('currentUser')))\n    }\n  }, [params.username, currentUser, setCurrentUser]);\n\n  useEffect(() => {\n    if (currentUser) {\n      const fetchProfile = async () => {\n        try {\n          const token = localStorage.getItem('token');\n          const response = await axios.get(`http://localhost:5000/api/auth/profile/${currentUser}`, {\n            headers: { Authorization: `Bearer ${token}` }\n          });\n          setLoading(false); // Set loading to false after data is fetched\n          setProfileData(response.data); // Set profile data to the response data object\n          console.log(localStorage.getItem('token'))\n        } catch (error) {\n          console.error('Error fetching profile data:', error);\n          setError('An error occurred while fetching profile data. Please try again later.');\n          setLoading(false); // Set loading to false in case of error\n        }\n      };\n      fetchProfile();\n    }\n  }, [currentUser, setProfileData]);\n\n  if (loading) {\n    return <div>Loading...</div>; // Render loading state\n  }\n\n  if (error) {\n    return <div>Error: {error}</div>; // Render error state\n  }\n\n\n\n  return (\n    <div className=\"d-flex justify-content-center mt-4\">\n      <div className=\"card mx-auto my-auto col-md-8 col-lg-6 col-sm-10 border border-3 border-dark shadow-lg\">\n        <div className=\"row d-flex my-auto\">\n          <div className=\"card-body d-flex my-auto\">\n            <div className=\"container\">\n              <h1 className=\"card-title d-flex justify-content-center m-4\">\n                welcome, {profileData.user.username}!\n              </h1>\n              {profileData && (\n                <div className=\"fs-3\">\n                  <div>\n                    profile balance: ${profileData.user.balance}.00\n\n                  </div>\n                  <div>\n\n                    email: {profileData.user.email}\n                  </div>\n                  <div>\n                    account id: {JSON.stringify(profileData.user._id).slice(15).replace('\"', '')}\n                  </div>\n                </div>\n\n              )}\n\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Profile;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,CAAEC,UAAU,KAAQ,OAAO,CAC9D,OAASC,cAAc,KAAQ,WAAW,CAC1C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,SAAS,KAAQ,kBAAkB,CAC5C,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE/C,KAAM,CAAAC,OAAO,CAAGA,CAAA,GAAM,CACpB,KAAM,CAAEC,cAAc,CAAEC,WAAW,CAAEC,WAAW,CAAEC,cAAe,CAAC,CAAGb,UAAU,CAACC,cAAc,CAAC,CAC/F,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACiB,KAAK,CAAEC,QAAQ,CAAC,CAAGlB,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAAAmB,MAAM,CAAGf,SAAS,CAAC,CAAC,CAC1B,KAAM,CAAAgB,QAAQ,CAAGf,WAAW,CAAC,CAAC,CAE9BN,SAAS,CAAC,IAAM,CACd,KAAM,CAAAsB,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAI,CAACF,KAAK,CAAE,CACVD,QAAQ,CAAC,GAAG,CAAC,CACf,CACF,CAAC,CAAC,CAEFrB,SAAS,CAAC,IAAM,CACd,GAAIa,WAAW,CAAE,CACfY,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAGb,WAAW,CAAC,CAChE,CACA,GAAI,CAACA,WAAW,CAAE,CAChBD,cAAc,CAACe,IAAI,CAACC,KAAK,CAACL,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,CACjE,CACF,CAAC,CAAE,CAACJ,MAAM,CAACS,QAAQ,CAAEhB,WAAW,CAAED,cAAc,CAAC,CAAC,CAElDZ,SAAS,CAAC,IAAM,CACd,GAAIa,WAAW,CAAE,CACf,KAAM,CAAAiB,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF,KAAM,CAAAR,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAO,QAAQ,CAAG,KAAM,CAAA3B,KAAK,CAAC4B,GAAG,2CAAAC,MAAA,CAA2CpB,WAAW,EAAI,CACxFqB,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAYX,KAAK,CAAG,CAC9C,CAAC,CAAC,CACFL,UAAU,CAAC,KAAK,CAAC,CAAE;AACnBF,cAAc,CAACgB,QAAQ,CAACK,IAAI,CAAC,CAAE;AAC/BX,OAAO,CAACC,GAAG,CAACH,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CAC5C,CAAE,MAAON,KAAK,CAAE,CACdO,OAAO,CAACP,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACpDC,QAAQ,CAAC,wEAAwE,CAAC,CAClFF,UAAU,CAAC,KAAK,CAAC,CAAE;AACrB,CACF,CAAC,CACDa,YAAY,CAAC,CAAC,CAChB,CACF,CAAC,CAAE,CAACjB,WAAW,CAAEE,cAAc,CAAC,CAAC,CAEjC,GAAIC,OAAO,CAAE,CACX,mBAAOR,IAAA,QAAA6B,QAAA,CAAK,YAAU,CAAK,CAAC,CAAE;AAChC,CAEA,GAAInB,KAAK,CAAE,CACT,mBAAOR,KAAA,QAAA2B,QAAA,EAAK,SAAO,CAACnB,KAAK,EAAM,CAAC,CAAE;AACpC,CAIA,mBACEV,IAAA,QAAK8B,SAAS,CAAC,oCAAoC,CAAAD,QAAA,cACjD7B,IAAA,QAAK8B,SAAS,CAAC,wFAAwF,CAAAD,QAAA,cACrG7B,IAAA,QAAK8B,SAAS,CAAC,oBAAoB,CAAAD,QAAA,cACjC7B,IAAA,QAAK8B,SAAS,CAAC,0BAA0B,CAAAD,QAAA,cACvC3B,KAAA,QAAK4B,SAAS,CAAC,WAAW,CAAAD,QAAA,eACxB3B,KAAA,OAAI4B,SAAS,CAAC,8CAA8C,CAAAD,QAAA,EAAC,WAClD,CAACvB,WAAW,CAACyB,IAAI,CAACV,QAAQ,CAAC,GACtC,EAAI,CAAC,CACJf,WAAW,eACVJ,KAAA,QAAK4B,SAAS,CAAC,MAAM,CAAAD,QAAA,eACnB3B,KAAA,QAAA2B,QAAA,EAAK,oBACe,CAACvB,WAAW,CAACyB,IAAI,CAACC,OAAO,CAAC,KAE9C,EAAK,CAAC,cACN9B,KAAA,QAAA2B,QAAA,EAAK,SAEI,CAACvB,WAAW,CAACyB,IAAI,CAACE,KAAK,EAC3B,CAAC,cACN/B,KAAA,QAAA2B,QAAA,EAAK,cACS,CAACV,IAAI,CAACe,SAAS,CAAC5B,WAAW,CAACyB,IAAI,CAACI,GAAG,CAAC,CAACC,KAAK,CAAC,EAAE,CAAC,CAACC,OAAO,CAAC,GAAG,CAAE,EAAE,CAAC,EACzE,CAAC,EACH,CAEN,EAEE,CAAC,CACH,CAAC,CACH,CAAC,CACH,CAAC,CACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAlC,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}