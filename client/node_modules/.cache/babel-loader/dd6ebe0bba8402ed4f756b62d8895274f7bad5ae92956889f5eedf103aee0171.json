{"ast":null,"code":"import React,{useContext,useState,useEffect}from'react';import{AccountContext}from'./context';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Withdraw=()=>{const{taketh,currentUser,setCurrentUser,profileData,setProfileData}=useContext(AccountContext);const[withdrawAmount,setWithdrawAmount]=useState('');const[withdrawError,setWithdrawError]=useState(null);const[usingTotal,setUsingTotal]=useState(true);const[total,setTotal]=useState([]);const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem('token');if(!token){navigate('/');}});useEffect(()=>{if(!currentUser){setCurrentUser(JSON.parse(localStorage.getItem('currentUser')));}},[currentUser,setCurrentUser]);useEffect(()=>{console.log(currentUser);console.log(\"total: \"+total);});useEffect(()=>{if(currentUser){const fetchProfileTotal=async()=>{try{const token=localStorage.getItem('token');const response=await axios.get(\"http://localhost:5000/api/auth/profile/\".concat(currentUser,\"/total\"),{headers:{Authorization:\"Bearer \".concat(token)}});setTotal(response.data.user.balance);}catch(error){console.error('Error fetching profile data:',error);console.error('An error occurred while fetching profile data. Please try again later.');}};fetchProfileTotal();}},[currentUser,setProfileData,total]);const yup=()=>toast.success(\"withdraw successful! :)\",{position:'top-center',closeOnClick:true,theme:'colored',hideProgressBar:true,autoClose:3000});const nope=()=>toast.error(\"withdraw unsuccessful. :(\",{position:'top-center',closeOnClick:true,theme:'colored',hideProgressBar:true,autoClose:3000});const handleSubmit=e=>{e.preventDefault();if(withdrawAmount>total||withdrawAmount<=0){nope();// setWithdrawAmount('')\nreturn null;}yup();taketh(withdrawAmount);const withdrawCall=async()=>{try{const token=localStorage.getItem('token');const response=await axios.post(\"http://localhost:5000/api/auth/profile/\".concat(currentUser,\"/withdraw\"),{currentUser,withdrawAmount},{headers:{Authorization:\"Bearer \".concat(token)}});setProfileData(response.data);setUsingTotal(false);}catch(error){console.log(\"withdrawAmount in withdrawcall error: \"+withdrawAmount);console.error('Error making deposit (deposit.js - axios call): ',error);setWithdrawError('An error occurred while making withdraw. get rekt lmao.');}};withdrawCall();// setWithdrawAmount('')\n};const handleInputChange=e=>{setWithdrawAmount(e.target.value);};if(withdrawError){return/*#__PURE__*/_jsx(\"div\",{children:withdrawError});}return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-center mt-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card col-lg-6 col-md-8 col-sm-6 shadow-lg border border-3 border-dark bg-light\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container  d-flex justify-content-center\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>handleSubmit(e),children:[/*#__PURE__*/_jsx(\"h1\",{className:\"card-title d-flex justify-content-center mb-3\",children:\"Withdraw\"}),usingTotal&&/*#__PURE__*/_jsxs(\"h4\",{className:\"ms-3\",children:[\"User Balance: $\",total,\".00\"]}),usingTotal===false&&/*#__PURE__*/_jsxs(\"h4\",{className:\"ms-3\",children:[\"User Balance: $\",profileData.balance,\".00\"]}),/*#__PURE__*/_jsx(\"label\",{className:\"m-2\",children:\"enter withdrawal amount below:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:withdrawAmount,onChange:e=>handleInputChange(e),placeholder:\"$0.00...\",className:\"form-control shadow-lg border border-2 border-secondary\",autoFocus:true}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center mt-3\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark shadow-lg\",type:\"submit\",children:/*#__PURE__*/_jsx(\"b\",{children:\"submit\"})})})]})})})}),/*#__PURE__*/_jsx(ToastContainer,{toastStyle:{border:'4px solid peachpuff'}})]});};export default Withdraw;","map":{"version":3,"names":["React","useContext","useState","useEffect","AccountContext","ToastContainer","toast","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Withdraw","taketh","currentUser","setCurrentUser","profileData","setProfileData","withdrawAmount","setWithdrawAmount","withdrawError","setWithdrawError","usingTotal","setUsingTotal","total","setTotal","navigate","token","localStorage","getItem","JSON","parse","console","log","fetchProfileTotal","response","get","concat","headers","Authorization","data","user","balance","error","yup","success","position","closeOnClick","theme","hideProgressBar","autoClose","nope","handleSubmit","e","preventDefault","withdrawCall","post","handleInputChange","target","value","children","className","onSubmit","type","onChange","placeholder","autoFocus","toastStyle","border"],"sources":["/Users/mrc/bb/client/src/visitable/withdraw.js"],"sourcesContent":["\nimport React, { useContext, useState, useEffect } from 'react'\nimport { AccountContext } from './context'\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom'\n\nconst Withdraw = () => {\n    const { taketh, currentUser, setCurrentUser, profileData, setProfileData } = useContext(AccountContext)\n    const [withdrawAmount, setWithdrawAmount] = useState('')\n    const [withdrawError, setWithdrawError] = useState(null)\n    const [usingTotal, setUsingTotal] = useState(true)\n    const [total, setTotal] = useState([])\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        const token = localStorage.getItem('token')\n        if (!token) {\n            navigate('/')\n        }\n    })\n\n    useEffect(() => {\n        if (!currentUser) {\n            setCurrentUser(JSON.parse(localStorage.getItem('currentUser')))\n        }\n    }, [currentUser, setCurrentUser]);\n\n    useEffect(() => {\n        console.log(currentUser)\n        console.log(\"total: \" + total)\n    })\n\n    useEffect(() => {\n        if (currentUser) {\n            const fetchProfileTotal = async () => {\n                try {\n                    const token = localStorage.getItem('token');\n                    const response = await axios.get(`http://localhost:5000/api/auth/profile/${currentUser}/total`, {\n                        headers: { Authorization: `Bearer ${token}` }\n                    });\n                    setTotal(response.data.user.balance);\n                } catch (error) {\n                    console.error('Error fetching profile data:', error);\n                    console.error('An error occurred while fetching profile data. Please try again later.');\n                }\n            };\n            fetchProfileTotal();\n        }\n    }, [currentUser, setProfileData, total]);\n\n    const yup = () => toast.success(\"withdraw successful! :)\", {\n        position: 'top-center',\n        closeOnClick: true,\n        theme: 'colored',\n        hideProgressBar: true,\n        autoClose: 3000,\n\n    })\n\n    const nope = () => toast.error(\"withdraw unsuccessful. :(\", {\n        position: 'top-center',\n        closeOnClick: true,\n        theme: 'colored',\n        hideProgressBar: true,\n        autoClose: 3000,\n\n    })\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        if (withdrawAmount > total || withdrawAmount <= 0) {\n            nope()\n            // setWithdrawAmount('')\n            return null\n        }\n\n        yup()\n        taketh(withdrawAmount)\n\n        const withdrawCall = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                const response = await axios.post(`http://localhost:5000/api/auth/profile/${currentUser}/withdraw`,\n                    { currentUser, withdrawAmount }, {\n                    headers: { Authorization: `Bearer ${token}` }\n                });\n                setProfileData(response.data)\n                setUsingTotal(false)\n            } catch (error) {\n                console.log(\"withdrawAmount in withdrawcall error: \" + withdrawAmount)\n                console.error('Error making deposit (deposit.js - axios call): ', error);\n                setWithdrawError('An error occurred while making withdraw. get rekt lmao.');\n            }\n        };\n        withdrawCall();\n        // setWithdrawAmount('')\n\n    }\n\n    const handleInputChange = (e) => {\n        setWithdrawAmount(e.target.value)\n    }\n    if (withdrawError) {\n        return <div>{withdrawError}</div>;\n    }\n\n    return (\n        <div className='d-flex justify-content-center mt-4'>\n\n            <div className='card col-lg-6 col-md-8 col-sm-6 shadow-lg border border-3 border-dark bg-light'>\n                <div className='card-body'>\n                    <div className='container  d-flex justify-content-center'>\n\n                        <form onSubmit={(e) => handleSubmit(e)}>\n                            <h1 className='card-title d-flex justify-content-center mb-3'>Withdraw</h1>\n                            {usingTotal &&\n                                <h4 className='ms-3'>User Balance: ${total}.00</h4>\n                            }\n                            {usingTotal === false &&\n                                <h4 className='ms-3'>User Balance: ${profileData.balance}.00</h4>\n                            }\n                            <label className='m-2'>enter withdrawal amount below:</label>\n                            <input type='number' value={withdrawAmount} onChange={(e) => handleInputChange(e)} placeholder='$0.00...' className='form-control shadow-lg border border-2 border-secondary' autoFocus />\n\n                            <div className='d-flex justify-content-center mt-3'>\n                                <button className='btn btn-dark shadow-lg' type='submit'><b>submit</b></button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n            <ToastContainer toastStyle={{ border: '4px solid peachpuff' }} />\n\n        </div>\n    )\n}\n\nexport default Withdraw\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}